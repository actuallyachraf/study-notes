
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{Discrete Logarithm Problem - DSA \& Schnorr Signatures over Zp}
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}11}]:} \PY{k}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{hello world}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
hello world

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}12}]:} \PY{n}{load}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{utils.py}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \subsection{Discrete Logarithm
Problem}\label{discrete-logarithm-problem}

The discrete logarithm problem can be summarized as finding \(x\) such
as \(g^x = y\) given \(g\) . In our case \(g\) is a generator of a
subgroup of order \(q\) a prime divisor of \((p-1)\).

The tuple \((p,q,g)\) is public, \(x\) ,\emph{the private key}, is an
integer sampled at random from \(<g>\) the subgroup generated by \(g\).
The public key is simply \(y\).

    \subsection{Discrete Logarithm Parameter
Generation}\label{discrete-logarithm-parameter-generation}

Our goal is to generate public parameters for our system based on the
DLP. The ingredients required are a large prime \(p\) (1024-bit...) a
prime divisor of \(p-1\) and a generator. Finding the generator is the
only \emph{costly} operation using \textbf{Fermat Last Theorem} we will
be able to compute it easily.

\begin{itemize}
\tightlist
\item
  Input : Security parameter l,t
\item
  Output : DL Domain parameters (p,q,g)
\end{itemize}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Select a t-bit prime \(q\) and an l-bit prime \(p\) such as
  \(q | p-1\).
\item
  Finding an element g of order q (finding the generator):

  2.1. Select an arbitrary \(h \in [1,p-1]\) and compute
  \(g = h^{((p-1)/q)} \mod p\)

  2.2. If g = 1 then go to step 2.1 \((Pr(g=1) = 1/p)\)
\item
  Return (p,q,g)
\end{enumerate}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}13}]:} \PY{k}{def} \PY{n+nf}{dlp\PYZus{}param\PYZus{}gen}\PY{p}{(}\PY{n}{l}\PY{p}{,}\PY{n}{t}\PY{p}{)}\PY{p}{:}
             \PY{n}{p} \PY{o}{=} \PY{n}{random\PYZus{}prime}\PY{p}{(}\PY{l+m+mi}{2}\PY{o}{\PYZca{}}\PY{n}{l}\PY{p}{,}\PY{n}{lbound}\PY{o}{=}\PY{l+m+mi}{2}\PY{o}{\PYZca{}}\PY{p}{(}\PY{n}{l}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
             \PY{n}{q} \PY{o}{=} \PY{n}{prime\PYZus{}divisors}\PY{p}{(}\PY{n}{p}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]} \PY{c+c1}{\PYZsh{} get the largest prime divisor of p\PYZhy{}1}
             \PY{n}{h} \PY{o}{=} \PY{n}{randint}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{p}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
             \PY{n}{y} \PY{o}{=} \PY{n}{Integer}\PY{p}{(}\PY{p}{(}\PY{n}{p}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{/}\PY{n}{q}\PY{p}{)}
             \PY{n}{g} \PY{o}{=} \PY{n}{power\PYZus{}mod}\PY{p}{(}\PY{n}{h}\PY{p}{,}\PY{n}{y}\PY{p}{,}\PY{n}{p}\PY{p}{)}
             \PY{k}{if} \PY{n}{g} \PY{o}{==} \PY{l+m+mi}{1} \PY{p}{:}
                 \PY{n}{g} \PY{o}{=} \PY{n}{power\PYZus{}mod}\PY{p}{(}\PY{n}{h}\PY{p}{,}\PY{n}{Integer}\PY{p}{(}\PY{p}{(}\PY{n}{p}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{/}\PY{o}{/}\PY{n}{q}\PY{p}{)}\PY{p}{,}\PY{n}{p}\PY{p}{)}
             \PY{k}{return} \PY{p}{(}\PY{n}{p}\PY{p}{,}\PY{n}{q}\PY{p}{,}\PY{n}{g}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}14}]:} \PY{n}{p}\PY{p}{,}\PY{n}{q}\PY{p}{,}\PY{n}{g} \PY{o}{=} \PY{n}{dlp\PYZus{}param\PYZus{}gen}\PY{p}{(}\PY{l+m+mi}{256}\PY{p}{,}\PY{l+m+mi}{128}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}15}]:} \PY{n}{is\PYZus{}prime}\PY{p}{(}\PY{n}{q}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}15}]:} True
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}16}]:} \PY{n}{is\PYZus{}prime}\PY{p}{(}\PY{n}{p}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}16}]:} True
\end{Verbatim}
            
    \subsection{Keypair generation}\label{keypair-generation}

Since we're doing public key crypto we need to generate a keypair
composed of our secret private key and a public key. The algorithm to do
so is as follows :

\begin{itemize}
\tightlist
\item
  Input : Domain parameters \((p,q,g)\)
\item
  Output : public key \(y\) and private key \(x\)
\end{itemize}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Sample \(x \in [1,q-1]\)
\item
  Compute \(y = g^x \mod p\)
\item
  Return \((y,x)\)
\end{enumerate}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}17}]:} \PY{k}{def} \PY{n+nf}{dlp\PYZus{}keygen}\PY{p}{(}\PY{n}{p}\PY{p}{,}\PY{n}{q}\PY{p}{,}\PY{n}{g}\PY{p}{)}\PY{p}{:}
             \PY{n}{x} \PY{o}{=} \PY{n}{randint}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{q}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
             \PY{n}{y} \PY{o}{=} \PY{n}{power\PYZus{}mod}\PY{p}{(}\PY{n}{g}\PY{p}{,}\PY{n}{x}\PY{p}{,}\PY{n}{p}\PY{p}{)}
             \PY{k}{return} \PY{p}{(}\PY{n}{y}\PY{p}{,}\PY{n}{x}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}18}]:} \PY{p}{(}\PY{n}{y}\PY{p}{,}\PY{n}{x}\PY{p}{)} \PY{o}{=} \PY{n}{dlp\PYZus{}keygen}\PY{p}{(}\PY{n}{p}\PY{p}{,}\PY{n}{q}\PY{p}{,}\PY{n}{g}\PY{p}{)}
\end{Verbatim}


    \subsection{Encryption and Decryption}\label{encryption-and-decryption}

You can refer to
\href{https://stackoverflow.com/questions/45617188/converting-elgamal-encryption-from-encrypting-numbers-to-strings}{this
answer} from stack overflow for more details.

Since you're encrypting using numbers doing so for a \emph{plaintext}
such as a credit card number or a \textbf{short message} is trivial you
simple take your \emph{text or binary data} turn it into a bytes then
encode the bytes into a \emph{big integer}.

Doing so for bytes is obvious since a string is just an array of bytes,
encoding into big integers depends on your language (whether it supports
arbitrary precision integers or needs a library).

When I say \textbf{short message} I point to the fact that your message
needs to be smaller than the \(p\) parameter since it needs to be inside
the \emph{group we're working on} in this case \(\mathbb{Z_p}\) .

\subsection{Signature and DSA}\label{signature-and-dsa}

The principle behind signing is authenticating the source of the data.
In our case Alice signs a message to prove to Bob the message's content
and authenticity.

A great example is \href{https://ethereum.org}{ethereum}, to send some
\emph{ether} to Bob,Alice constructs a transaction saying \emph{send
10ether to Bob from this account} here's a signature \(s\) proving
\emph{I did authorize the transaction}.

Ethereum of course uses a better construction based on Elliptic Curves
(the subject of the next set of notes).

Here we'll see \textbf{DSA}, the Digital Signature Algorithm was
proposed by NIST in 1991. You have to know the difference between the
signature algorithm and the math itself, the algorithm only does some
computation to build hard to solve and easy to verify problems.

There can be many algorithms in fact we'll see another one designed by
\textbf{Schnorr} that was pattented until 2008. The algorithm can remain
the same (require slight modifications) and we can instead change the
\emph{math}, that's in a sense how this thing works the math provides us
with security guarrentees that \emph{this equation is difficult to solve
here are some big numbers to use for doing equation stuff}.

The DSA algorithm works as follows :

\begin{itemize}
\item
  Input : Domain parameters : \((p,q,g)\),private key \(x\),message
  \(m\)
\item
  Output : a signature \((r,s)\)

  1.Sample a random \(k \in [1,q-1]\).

  2.Compute \(T = g^k \mod p\).

  3.Compute \(r = T \mod q\) if \(r=0\) recompute go to 1.

  4.Compute \(h = H(m)\) , \(H\) is a hash function.

  5.Compute \(s = k^{-1} ( h + xr) \mod q\) if \(s=0\) go to 1.

  6.Return (r,s)
\end{itemize}

The DSA signature verification algorithm works as follows :

\begin{itemize}
\item
  Input : Domain parameters : \((p,q,g)\),public key \(y\),message \(m\)
  ,signature \((r,s)\)
\item
  Output : Boolean

  \begin{enumerate}
  \def\labelenumi{\arabic{enumi}.}
  \tightlist
  \item
    Verify that r,s are in the interval \([1,q-1]\) reject if not
  \item
    Compute \(h = H(m)\)
  \item
    Compute \(w = s^{-1} \mod q\)
  \item
    Compute \(u_1 = hw \mod q\)
  \item
    Compute \(u_2 = rw \mod q\)
  \item
    Compute \(T = g^{u_1}y^{u_2} \mod p\)
  \item
    Compute \(r' = T \mod q\)
  \item
    If \(r = r'\) then the signature is valid otherwise reject it.
  \end{enumerate}
\end{itemize}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}21}]:} \PY{n}{message} \PY{o}{=} \PY{l+s+sa}{b}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Nobody inspects}\PY{l+s+s2}{\PYZdq{}}
         \PY{n}{messageHash} \PY{o}{=} \PY{n}{sha256py}\PY{p}{(}\PY{n}{b}\PY{p}{)}
         \PY{n}{msgHashBytes} \PY{o}{=} \PY{n+nb}{bytearray}\PY{p}{(}\PY{n}{h}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}25}]:} \PY{k}{def} \PY{n+nf}{int\PYZus{}from\PYZus{}bytes}\PY{p}{(}\PY{n}{b}\PY{p}{)}\PY{p}{:}
             \PY{n}{n} \PY{o}{=} \PY{l+m+mi}{0}
             \PY{k}{for} \PY{n}{byte} \PY{o+ow}{in} \PY{n}{msgHashBytes}\PY{p}{:}
                 \PY{n}{n} \PY{o}{=} \PY{n}{n}\PY{o}{\PYZlt{}\PYZlt{}}\PY{l+m+mi}{8} \PY{o}{|} \PY{n}{byte}
             \PY{k}{return} \PY{n}{n}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}26}]:} \PY{n}{msgPoint} \PY{o}{=} \PY{n}{int\PYZus{}from\PYZus{}bytes}\PY{p}{(}\PY{n}{msgHashBytes}\PY{p}{)}
         
         \PY{n}{msgPoint} \PY{o}{\PYZlt{}} \PY{p}{(}\PY{n}{p}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}26}]:} True
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}44}]:} \PY{k}{def} \PY{n+nf}{dlp\PYZus{}dsa\PYZus{}sign}\PY{p}{(}\PY{n}{p}\PY{p}{,}\PY{n}{q}\PY{p}{,}\PY{n}{g}\PY{p}{,}\PY{n}{x}\PY{p}{,}\PY{n}{h}\PY{p}{)}\PY{p}{:}
             \PY{n}{k} \PY{o}{=} \PY{n}{randint}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{q}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
             \PY{n}{T} \PY{o}{=} \PY{n}{power\PYZus{}mod}\PY{p}{(}\PY{n}{g}\PY{p}{,}\PY{n}{k}\PY{p}{,}\PY{n}{p}\PY{p}{)}
             \PY{n}{r} \PY{o}{=} \PY{n}{mod}\PY{p}{(}\PY{n}{T}\PY{p}{,}\PY{n}{q}\PY{p}{)}
             \PY{k}{if} \PY{n}{r} \PY{o}{==} \PY{l+m+mi}{0} \PY{p}{:}
                 \PY{k}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{r=0 repeat}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
             \PY{n}{invk} \PY{o}{=} \PY{n}{inverse\PYZus{}mod}\PY{p}{(}\PY{n}{k}\PY{p}{,}\PY{n}{q}\PY{p}{)}
             \PY{n}{secpart} \PY{o}{=} \PY{p}{(}\PY{n}{Integer}\PY{p}{(}\PY{n}{h}\PY{p}{)} \PY{o}{+} \PY{p}{(}\PY{n}{x}\PY{o}{*}\PY{n}{r}\PY{p}{)} \PY{o}{\PYZpc{}} \PY{n}{q}\PY{p}{)} \PY{o}{\PYZpc{}}\PY{k}{q}
             \PY{n}{s1} \PY{o}{=} \PY{n}{invk}\PY{o}{*}\PY{n}{secpart}
             \PY{n}{s} \PY{o}{=} \PY{n}{s1} \PY{o}{\PYZpc{}} \PY{n}{q}
             \PY{k}{if} \PY{n}{s} \PY{o}{==} \PY{l+m+mi}{0} \PY{p}{:}
                 \PY{k}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{s=0 repeat}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
             \PY{k}{return} \PY{p}{(}\PY{n}{r}\PY{p}{,}\PY{n}{s}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}45}]:} \PY{n}{r}\PY{p}{,}\PY{n}{s} \PY{o}{=} \PY{n}{dlp\PYZus{}dsa\PYZus{}sign}\PY{p}{(}\PY{n}{p}\PY{p}{,}\PY{n}{q}\PY{p}{,}\PY{n}{g}\PY{p}{,}\PY{n}{x}\PY{p}{,}\PY{n}{msgPoint}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}46}]:} \PY{k}{print}\PY{p}{(}\PY{n}{r} \PY{o}{\PYZlt{}} \PY{p}{(}\PY{n}{q}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
         \PY{k}{print}\PY{p}{(}\PY{n}{s} \PY{o}{\PYZlt{}} \PY{p}{(}\PY{n}{q}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
         \PY{k}{print}\PY{p}{(}\PY{n}{p}\PY{p}{,}\PY{n}{q}\PY{p}{,}\PY{n}{g}\PY{p}{,}\PY{n}{y}\PY{p}{,}\PY{n}{r}\PY{p}{,}\PY{n}{s}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
True
True
(113377137750698992514901559591257981535085762510979630262220173300076725844389, 145781614272749218536927089054294369, 13743192433586752580922535577223971295725355363763292863497585116126565241744, 52805610933121568656382851904751315685369793561473300368000311375497674784972, 28900507199467140063486050821381627, 123908120214468337562239144391336313)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}47}]:} \PY{k}{def} \PY{n+nf}{dlp\PYZus{}dsa\PYZus{}verify}\PY{p}{(}\PY{n}{p}\PY{p}{,}\PY{n}{q}\PY{p}{,}\PY{n}{g}\PY{p}{,}\PY{n}{y}\PY{p}{,}\PY{n}{r}\PY{p}{,}\PY{n}{s}\PY{p}{,}\PY{n}{h}\PY{p}{)}\PY{p}{:}
             \PY{c+c1}{\PYZsh{} if r or s isn\PYZsq{}t in [1,q\PYZhy{}1] reject the signature}
             \PY{n}{w} \PY{o}{=} \PY{n}{inverse\PYZus{}mod}\PY{p}{(}\PY{n}{Integer}\PY{p}{(}\PY{n}{s}\PY{p}{)}\PY{p}{,}\PY{n}{q}\PY{p}{)}
             \PY{n}{u1} \PY{o}{=} \PY{n}{mod}\PY{p}{(}\PY{n}{h}\PY{o}{*}\PY{n}{w}\PY{p}{,}\PY{n}{q}\PY{p}{)}
             \PY{n}{u2} \PY{o}{=} \PY{n}{mod}\PY{p}{(}\PY{n}{r}\PY{o}{*}\PY{n}{w}\PY{p}{,}\PY{n}{q}\PY{p}{)}
             \PY{n}{T1} \PY{o}{=} \PY{n}{power\PYZus{}mod}\PY{p}{(}\PY{n}{g}\PY{p}{,}\PY{n}{Integer}\PY{p}{(}\PY{n}{u1}\PY{p}{)}\PY{p}{,}\PY{n}{p}\PY{p}{)}
             \PY{n}{T2} \PY{o}{=} \PY{n}{power\PYZus{}mod}\PY{p}{(}\PY{n}{y}\PY{p}{,}\PY{n}{Integer}\PY{p}{(}\PY{n}{u2}\PY{p}{)}\PY{p}{,}\PY{n}{p}\PY{p}{)}
             \PY{n}{T} \PY{o}{=} \PY{n}{mod}\PY{p}{(}\PY{p}{(}\PY{n}{T1}\PY{o}{*}\PY{n}{T2}\PY{p}{)}\PY{p}{,}\PY{n}{p}\PY{p}{)} 
             \PY{n}{rp} \PY{o}{=} \PY{n}{mod}\PY{p}{(}\PY{n}{T}\PY{p}{,}\PY{n}{q}\PY{p}{)}
             \PY{k}{if} \PY{n}{r} \PY{o}{==} \PY{n}{rp}\PY{p}{:}
                 \PY{k}{return} \PY{n+nb+bp}{True}
             \PY{k}{else} \PY{p}{:}
                 \PY{k}{return} \PY{n+nb+bp}{False}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}48}]:} \PY{n}{dlp\PYZus{}dsa\PYZus{}verify}\PY{p}{(}\PY{n}{p}\PY{p}{,}\PY{n}{q}\PY{p}{,}\PY{n}{g}\PY{p}{,}\PY{n}{y}\PY{p}{,}\PY{n}{r}\PY{p}{,}\PY{n}{s}\PY{p}{,}\PY{n}{msgPoint}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}48}]:} True
\end{Verbatim}
            
    To wrap up this let's write a proof that the signature validation
algorithm is correct

\(Proof\) :

\begin{itemize}
\item
  Let \(k\) a random element we have \(T = g^k \mod p\)
\item
  let \(r = T \mod q\) and \(s = k^{-1} (h+xr) \mod q\)
\item
  Verifier doesn't know x nor k but using algebra we can see that
  \(k = s^{-1} (h+xr) \mod q\)
\item
  We raise both sides to \(g\) \$ g\^{}k = g\textsuperscript{\{hs}\{-1\}
  + xr\{s\^{}\{-1\}\}\} \mod q\$
\item
  We decompose the right hand side
  \(g^k = g^{hs^{-1}} . g^{xrs^{-1}} \mod q\)
\item
  \(g^x = y\) thus \(g^k = g^{hs^{-1}} . y^{rs^{-1}} \mod q\)
\item
  The verifier now computes \(T = (g^{hs^{-1}} . y^{rs^{-1}} \mod q)\)
  and verifies \(r' = T \mod q\) is equal to \(r\) \(\square\)
\end{itemize}

    \subsection{Schnorr Signature
Algorithm}\label{schnorr-signature-algorithm}

So a signature is a \emph{proof of knowledge of y} and we can describe a
\emph{signature algorithms} ase a sequence of computations used to
generate a \textbf{proof} and \textbf{verify} a proof.

The Schnorr signature algorithm is actually an \emph{interactive zero
knowledge proof of logarithm} you can read the
\href{https://pdfs.semanticscholar.org/8d69/c06d48b618a090dd19185aea7a13def894a5.pdf}{paper}
there's a nice construction in cryptography called the
\href{https://pdfs.semanticscholar.org/b904/6d002da153a6fe9b06d469da4efffdfcb9c6.pdf}{fiat-shamir
heuristic} that can turn any \emph{interactive proof} to a
\emph{non-interactive one}.

\begin{quote}
\textbf{Say I want to let you know that I know \(x\) such as \(g*x = y\)
and I want to prove it to you without disclosing \(x\).}
\end{quote}

Well \emph{Schnorr} thought hard and said well we can use randomness and
hash functions to build a solid protocol that is sound and complete
(Basically Verifier can't be cheated such as Prover proves a false
statement)

The protocol works like this :

\begin{itemize}
\item
  \textbf{(Commitment)} : Verifier samples a random
  \(v \in \mathbb{Z_q}\) and asks Prover for \(t = g^v\)
\item
  \(t\) is called a commitment it's a way to force the Prover to commit
  to \(g\).
\item
  \textbf{Challenge} : Verifier sends a challenge \(c = H(g,y,t)\)
\item
  \textbf{Response} : Prover computes \(r = v -cx \mod q\)
\item
  The \textbf{zero knowledge proof of x is \((c,r)\)}
\end{itemize}

To verify this the verifier can go trough the following steps :

\begin{itemize}
\item
  \(t' = g^r.y^c\)
\item
  \(t' = g^{(v-cx)}.y^c\)
\item
  \(t' = g^{(v-cx)}.g^xc\)
\item
  \(t' = g^{(v-cx + cx)} = g^v = t\)
\end{itemize}

Thus if x was indeed the correct answer we'd have \(H(g,y,t') = t\)

The signature algorithm and verification is no different than this
process.

Schnorr Signature Algorithm goes as follows:

\begin{itemize}
\item
  Input : (p,g,q), x,m
\item
  Output : (s,e)

  1.Sample a random \(k \in [1,q-1]\).

  2.Compute \(r = g^k \mod q\)

  3.Compute \(e = H(r||m)\) \textbar{}\textbar{} is the concatenation
  symbol as r is represented as bytes

  4.Compute \(s = k - xe\)

  5.return \((s,e)\)
\end{itemize}

Verifying schnorr signatures is easier the algorithm proceeds as follows

\begin{itemize}
\item
  Input : (p,q,g),y,(s,e),h
\item
  Output : True or Flase

  \begin{enumerate}
  \def\labelenumi{\arabic{enumi}.}
  \tightlist
  \item
    Let \(rv = g^s * y^e\)
  \item
    Let \$ev = H(rv\textbar{}\textbar{}h)
  \item
    If \(ev = e\) return True otherwise return False
  \end{enumerate}
\end{itemize}

\subsubsection{Notes :}\label{notes}

\begin{itemize}
\tightlist
\item
  For ease I basically work with hashes and verify the signatures over
  the hashes themselves in a public environment you should ask for the
  message itself and compute the hashes by yourself (ROM).
\end{itemize}

    Verifying the signature is as easy as compute \(ev = H(g^s.y^e||M)\) I
leave to you the implementation details.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}49}]:} \PY{k+kn}{from} \PY{n+nn}{Crypto.Util.number} \PY{k+kn}{import} \PY{n}{long\PYZus{}to\PYZus{}bytes}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}52}]:} \PY{n}{k} \PY{o}{=} \PY{n}{randint}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{q}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{r} \PY{o}{=} \PY{n}{power\PYZus{}mod}\PY{p}{(}\PY{n}{g}\PY{p}{,}\PY{n}{k}\PY{p}{,}\PY{n}{q}\PY{p}{)}
         \PY{n}{rb} \PY{o}{=} \PY{n}{long\PYZus{}to\PYZus{}bytes}\PY{p}{(}\PY{n}{r}\PY{p}{)}
         \PY{n}{rb}\PY{o}{.}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}52}]:} '\textbackslash{}t\textbackslash{}x91\textbackslash{}xf0t\textbackslash{}x80\textbackslash{}xc7\textbackslash{}xb9rJL\textbackslash{}xa5\textbackslash{}xa5\textbackslash{}xf7c\textbackslash{}xbb'
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}53}]:} \PY{k}{def} \PY{n+nf}{schnorr\PYZus{}sign}\PY{p}{(}\PY{n}{p}\PY{p}{,}\PY{n}{g}\PY{p}{,}\PY{n}{q}\PY{p}{,}\PY{n}{x}\PY{p}{,}\PY{n}{h}\PY{p}{)}\PY{p}{:}
             \PY{n}{k} \PY{o}{=} \PY{n}{randint}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{q}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
             \PY{n}{r} \PY{o}{=} \PY{n}{power\PYZus{}mod}\PY{p}{(}\PY{n}{g}\PY{p}{,}\PY{n}{k}\PY{p}{,}\PY{n}{q}\PY{p}{)}
             \PY{n}{rBytes} \PY{o}{=} \PY{n}{long\PYZus{}to\PYZus{}bytes}\PY{p}{(}\PY{n}{r}\PY{p}{)}
             \PY{n}{rm} \PY{o}{=} \PY{n}{rb} \PY{o}{+} \PY{n}{h}
             \PY{n}{eBytes} \PY{o}{=} \PY{n}{sha256py}\PY{p}{(}\PY{n}{rm}\PY{p}{)}
             \PY{n}{e} \PY{o}{=} \PY{n}{int\PYZus{}from\PYZus{}bytes}\PY{p}{(}\PY{n}{eBytes}\PY{p}{)}
             \PY{n}{s} \PY{o}{=} \PY{p}{(}\PY{n}{k} \PY{o}{\PYZhy{}} \PY{p}{(}\PY{n}{x}\PY{o}{*}\PY{n}{e}\PY{p}{)} \PY{o}{\PYZpc{}} \PY{n}{q}\PY{p}{)} \PY{o}{\PYZpc{}} \PY{n}{q}
             \PY{k}{return} \PY{p}{(}\PY{n}{s}\PY{p}{,}\PY{n}{e}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}54}]:} \PY{p}{(}\PY{n}{s}\PY{p}{,}\PY{n}{e}\PY{p}{)} \PY{o}{=} \PY{n}{schnorr\PYZus{}sign}\PY{p}{(}\PY{n}{p}\PY{p}{,}\PY{n}{q}\PY{p}{,}\PY{n}{g}\PY{p}{,}\PY{n}{x}\PY{p}{,}\PY{n}{msgHashBytes}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}57}]:} \PY{k}{def} \PY{n+nf}{schnorr\PYZus{}verify}\PY{p}{(}\PY{n}{p}\PY{p}{,}\PY{n}{q}\PY{p}{,}\PY{n}{g}\PY{p}{,}\PY{n}{y}\PY{p}{,}\PY{n}{s}\PY{p}{,}\PY{n}{e}\PY{p}{,}\PY{n}{h}\PY{p}{)}\PY{p}{:}
             \PY{n}{gs} \PY{o}{=} \PY{n}{power\PYZus{}mod}\PY{p}{(}\PY{n}{g}\PY{p}{,}\PY{n}{s}\PY{p}{,}\PY{n}{q}\PY{p}{)}
             \PY{n}{ye} \PY{o}{=} \PY{n}{power\PYZus{}mod}\PY{p}{(}\PY{n}{y}\PY{p}{,}\PY{n}{e}\PY{p}{,}\PY{n}{q}\PY{p}{)}
             \PY{n}{rv} \PY{o}{=} \PY{n}{gs} \PY{o}{*} \PY{n}{ye}
             \PY{n}{rvBytes} \PY{o}{=} \PY{n}{long\PYZus{}to\PYZus{}bytes}\PY{p}{(}\PY{n}{rv}\PY{p}{)}
             \PY{n}{rm} \PY{o}{=} \PY{n}{rvBytes} \PY{o}{+} \PY{n}{h}
             \PY{n}{evBytes} \PY{o}{=} \PY{n}{sha256py}\PY{p}{(}\PY{n}{rm}\PY{p}{)}
             \PY{n}{ev} \PY{o}{=} \PY{n}{int\PYZus{}from\PYZus{}bytes}\PY{p}{(}\PY{n}{evBytes}\PY{p}{)}
             \PY{k}{if} \PY{n}{ev} \PY{o}{==} \PY{n}{e} \PY{p}{:}
                 \PY{k}{return} \PY{n+nb+bp}{True}
             \PY{k}{return} \PY{n+nb+bp}{False}
             
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}58}]:} \PY{n}{schnorr\PYZus{}verify}\PY{p}{(}\PY{n}{p}\PY{p}{,}\PY{n}{q}\PY{p}{,}\PY{n}{g}\PY{p}{,}\PY{n}{x}\PY{p}{,}\PY{n}{s}\PY{p}{,}\PY{n}{e}\PY{p}{,}\PY{n}{msgHashBytes}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}58}]:} True
\end{Verbatim}
            

    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
